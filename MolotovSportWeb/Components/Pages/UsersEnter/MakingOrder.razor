@page "/MakingOrder"
@inject IJSRuntime JSRuntime
@rendermode InteractiveServer

@inject NavigationManager navigationManager
@using Microsoft.EntityFrameworkCore
@using MolotovSportWeb.Models

@inject MolotovSportWebContext context
@inject Classes.Servers.UserStateService UserState



<script  src="js/deliveryCalculator.js" type="text/javascript"></script>
<div id="map" ></div>



<button @onclick=getLocationFromJS>Get Location</button>
<p>@location</p>

<button @onclick="ClickNewOrder" class="StyleButtonVhod">Оформить</button>
@code {
    string location { get; set; }

    async Task getLocationFromJS()
    {
        location = await JSRuntime.InvokeAsync<string>("getLocation");
    }

    int idUser = 0;
    string adress = "Г. Березовский, ул. Красных героев 11, кв 41";

    protected override void OnParametersSet()

    {
        idUser = UserState.CheakUserId();
    }


    public void ClickNewOrder()
    {
        Classes.DataBase.CreateOrder createOrder = new Classes.DataBase.CreateOrder(idUser);

        createOrder.Create(adress);

        navigationManager.NavigateTo("/");
    }
}
